<template>
    <div>
        <LoginPage v-if="currentPage ==='loginPage'" @loginSubmit="login" ></LoginPage>
        <DashboardPage v-else-if="currentPage === 'dashboardPage'" :tasksData="tasks"> </DashboardPage>
    </div>
</template>

<script>
import axios from "./config/axios";
import LoginPage from "./views/Login";
import DashboardPage from './views/Dashboard' 

export default {
    name: 'app',
    components: {
        LoginPage,
        DashboardPage
    },
    data() {
        return {
            message: "halo",
            currentPage: "loginPage",
            tasks: []
        }
    },
    methods: {
        checkAuth(){
            if(localStorage.access_token){
                this.currentPage = 'dashboardPage'
            }
            else{
                this.currentPage = 'loginPage'
            }
        },
        login(payload){
            // axios({
            //     url: '/login',
            //     method: 'POST',
            //     data: payload
            // })
            axios.post("/login", payload)

            .then(({data}) => {
                this.currentPage = 'dashboardPage'
                localStorage.setItem('access_token', data.access_token)
            })
            .catch(err =>{
                console.log(err)
            })
        }
    },
    created() {
        if (localStorage.token) {
            this.page = `home`
        }
    }
};
</script>

<style>
    body {
        background-image: url("https://labourenergy.org/wp-content/uploads/2019/11/blank-chalkboard-background-high-resolution.jpg");
    }
</style> 